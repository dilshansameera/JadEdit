var EDITOR=(function(){var a={};a.getEditorTemplate=function(b){return"<div id='jadedit-container'><div id='jadedit-button-controls'><div id='jadedit-editor-button' class='chosen'>Editor</div><div id='jadedit-source-button'>Source</div><div id='jadedit-preview-button'>Preview</div></div><div id='jadedit-editor-container'><textarea id='jadedit-editor' spellcheck='false'></textarea><div id='jadedit-source' style='display: none;'></div><div id='jadedit-preview' style='display: none;'></div><input type='hidden' id='jadedit-hidden' name='"+b+"' /></div></div>"};return a}());var EVENTS=(function(){var a={};a.registerEditorEvents=function(b){b.editorButton.onclick=function(){b.preview.style.display="none";b.editor.style.display="block";b.source.style.display="none";b.editorButton.className="chosen";b.previewButton.className="";b.sourceButton.className=""};b.previewButton.onclick=function(){b.preview.style.display="block";b.editor.style.display="none";b.source.style.display="none";b.previewButton.className="chosen";b.editorButton.className="";b.sourceButton.className=""};b.sourceButton.onclick=function(){b.preview.style.display="none";b.editor.style.display="none";b.source.style.display="block";b.previewButton.className="";b.editorButton.className="";b.sourceButton.className="chosen"}};return a}());var UTIL=(function(){var a={};a.tabCounter=function(c){for(var b=0;b<c.length;b++){if(c[b]!="\t"){return b}}};a.trimStart=function(b){return b.replace(/^( |\t)+/,"")};return a}());var JADE_PROCESSOR=(function(c){var b={};b.process=function(i,f){var k=f[i];if(k.length<1){return{processedLine:"",newLocation:i}}var j="";var m=c.tabCounter(k);k=c.trimStart(k);var e=k[0]=="|";var h=k.indexOf(" ");if(h==-1){h=k.length}var g=k.substring(0,h);j+=c.trimStart(k.substring(h,k.length));while(i+1<f.length&&(m+1)==c.tabCounter(f[i+1])){i++;var l=this.process(i,f);j+=l.processedLine;i=l.newLocation}return{processedLine:d(g,j,e),newLocation:i}};function d(g,h,f){var e=a(c.trimStart(g));if(e.withoutAttribute==="pre"){if(!f){return"<"+e.withAttribute+">"+h+"</"+e.withoutAttribute+">"}else{return h}}if(e.withoutAttribute!=="br"&&e.withoutAttribute!=="pre"){if(!f){return"<"+e.withAttribute+">"+h+"</"+e.withoutAttribute+">\n"}else{return h+"\n"}}if(!f){return"<"+e.withAttribute+"/>"+h+"\n"}else{return h+"\n"}}function a(g){var h="";var e="";for(var f=0;f<g.length;f++){if(g[f]=="."){h+=" class='";f++;while(g[f]!="."&&g[f]!="#"&&f<g.length){h+=g[f];f++}if(g[f]=="."||g[f]=="#"){f--}h+="'"}else{if(g[f]=="#"){h+=" id='";f++;while(g[f]!="."&&g[f]!="#"&&f<g.length){h+=g[f];f++}if(g[f]=="."||g[f]=="#"){f--}h+="'"}else{if(g[f]=="("){while(g[f]!=")"&&f<g.length){}}else{h+=g[f];e+=g[f]}}}}return{withAttribute:h,withoutAttribute:e}}return b}(UTIL));var HTML_PROCESSOR=(function(b){var a={};a.process=function(){return""};return a}(UTIL));var PROCESSOR=(function(){var b={};var a={html:HTML_PROCESSOR,jade:JADE_PROCESSOR};a.setCurrentProcessor=function(c){if(c==="html"){b=a.html}else{if(c==="jade"){b=a.jade}}};a.process=function(g){var d="";var f=g.split("\n");for(var e=0;e<f.length;e++){var c=b.process(e,f);d+=c.processedLine;e=c.newLocation}return d};return a}());var JADE_HIGHLIGHTER=(function(a){var b={};b.highlight=function(){return""};return b}(UTIL));var HTML_HIGHLIGHTER=(function(b){var a=/(?!<)[A-Za-z'" =\d:]+(?=(>|\/>))/gi;var d={attribute:/(\s)+(class|id|href|type|rel|accesskey|hidden|required|style) ?(?=(=))/i,string:/(?![=](\s)+)['|"](.*?)['|"]/};var c={};c.highlight=function(i,e){var n=e[i];var k=n.match(a);var p="";if(k!=null){for(var h=0;h<k.length;h++){var f=n.substring(0,n.indexOf(k[h]));if(f.length>0){f=l("plain",f)}p+=f;var o=k[h];while(d.attribute.test(o)||d.string.test(o)){for(var m in d){if(d[m].test(o)){var g=d[m].exec(o);var j=g.index;if(o.substring(0,j)!="="){p+=l("keyword",o.substring(0,j))}else{p+=l("plain",o.substring(0,j))}p+=l(m,g[0]);o=o.substring(j+g[0].length,o.length)}}}p+=l("keyword",o);n=n.substring(n.indexOf(k[h])+k[h].length,n.length)}if(n.length!=0){p+=l("plain",n)}}else{p+=l("plain",n)}return{processedLine:p+"\n",newLocation:i};function l(q,s){var r=document.createElement("code");r.setAttribute("class",q);r.innerText=s;return r.outerHTML}};return c}(UTIL));var HIGHLIGHTER=(function(){var b={};var a={html:HTML_HIGHLIGHTER,jade:JADE_HIGHLIGHTER};a.setCurrentProcessor=function(c){if(c==="html"){b=a.html}else{if(c==="jade"){b=a.jade}}};a.highlight=function(g){var d="";var f=g.split("\n");for(var e=0;e<f.length;e++){var c=b.highlight(e,f);d+=c.processedLine;e=c.newLocation}return d};return a}());var KEYSTROKE_HANDLER=(function(b,c){var a={};a.enableTab=function(d){d.editor.onkeydown=function(g){if(g.keyCode===9){var h=this.value,i=this.selectionStart,f=this.selectionEnd;this.value=h.substring(0,i)+"\t"+h.substring(f);this.selectionStart=this.selectionEnd=i+1;return false}}};a.enablePreview=function(d){d.editor.onkeyup=function(){var e=b.process(d.editor.value);c.setCurrentProcessor("html");d.source.innerHTML=c.highlight(e);d.hidden.value=e;d.preview.innerHTML=e}};return a}(PROCESSOR,HIGHLIGHTER));(function Main(e,b,d,a){var f=document.getElementById("jadedit");if(f.length){document.write("Editor Container is not found.");return}if(!f.hasAttribute("name")){document.write("Editor does not have a name.");return}f.innerHTML=e.getEditorTemplate(f.getAttribute("name"));var c={editorButton:document.getElementById("jadedit-editor-button"),previewButton:document.getElementById("jadedit-preview-button"),sourceButton:document.getElementById("jadedit-source-button"),editor:document.getElementById("jadedit-editor"),source:document.getElementById("jadedit-source"),preview:document.getElementById("jadedit-preview"),hidden:document.getElementById("jadedit-hidden")};b.registerEditorEvents(c);d.enableTab(c);a.setCurrentProcessor("jade");d.enablePreview(c)}(EDITOR,EVENTS,KEYSTROKE_HANDLER,PROCESSOR));